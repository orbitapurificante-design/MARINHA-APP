<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<style>
body{font-family:sans-serif;padding:20px;background:#f4f1ec}
button{padding:12px 20px;background:#0a1628;color:#fff;border:none;border-radius:10px;font-size:15px;cursor:pointer;margin:6px 4px;display:block;width:100%}
#log{background:#fff;border-radius:10px;padding:14px;margin-top:16px;font-size:13px;line-height:2;word-break:break-all}
img{max-width:120px;border-radius:8px;display:block;margin:4px 0}
</style>
</head>
<body>
<h2>üîç Debug Supabase</h2>
<button onclick="verPromos()">Ver promo√ß√µes (com foto?)</button>
<button onclick="verFolhetos()">Ver folhetos (com imagem?)</button>
<button onclick="apagarTestes()">üóëÔ∏è Apagar promos de teste</button>
<div id="log">Clique num bot√£o...</div>

<script>
var SB='https://opzmuzogxfzeqwjxmfvc.supabase.co';
var SK='sb_publishable_e_Bd_rx2rfzBeIrbyGxCwA_SfXklv4s';
function hd(){return{'apikey':SK,'Authorization':'Bearer '+SK,'Content-Type':'application/json'};}
var L=document.getElementById('log');
function log(m){L.innerHTML+=m+'<br>';}
function clr(){L.innerHTML='';}

async function verPromos(){
  clr();log('A carregar promos...');
  var r=await fetch(SB+'/rest/v1/promos?select=*',{headers:hd()});
  var d=await r.json();
  log('Total: '+d.length+' promo√ß√µes');
  log('---');
  d.forEach(function(p){
    log('<strong>'+p.nome+'</strong>');
    log('ID: '+p.id);
    log('Pre√ßo: '+p.preco_orig+'‚Ç¨ ‚Üí '+p.preco_novo+'‚Ç¨');
    log('Emoji: '+(p.emoji||'nenhum'));
    log('Foto: '+(p.foto?'SIM ('+Math.round(p.foto.length/1024)+'KB)':'N√ÉO'));
    if(p.foto&&p.foto.length>100){
      log('<img src="'+p.foto+'">');
    }
    log('data_ini: '+(p.data_ini||'sem data'));
    log('data_fim: '+(p.data_fim||'sem data'));
    log('---');
  });
}

async function verFolhetos(){
  clr();log('A carregar folhetos...');
  var r=await fetch(SB+'/rest/v1/folhetos?select=*',{headers:hd()});
  var d=await r.json();
  log('Total: '+d.length+' folhetos');
  d.forEach(function(f){
    log('<strong>'+f.nome+'</strong>');
    log('Data/imagem: '+(f.data?'SIM ('+Math.round(f.data.length/1024)+'KB)':'N√ÉO'));
    if(f.data&&f.data.length>100){
      log('<img src="'+f.data+'">');
    }
    log('---');
  });
}

async function apagarTestes(){
  clr();log('A apagar promos de teste...');
  var r=await fetch(SB+"/rest/v1/promos?nome=eq.TESTE_FOTO",{method:'DELETE',headers:hd()});
  var r2=await fetch(SB+"/rest/v1/promos?nome=eq.TESTE_SEM_FOTO",{method:'DELETE',headers:hd()});
  log('Feito. Status: '+r.status+', '+r2.status);
}
</script>
</body>
</html>
